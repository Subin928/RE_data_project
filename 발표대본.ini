
# 슬라이드 1: 표지

안녕하세요. 저희조가 발표할 주제는 '장마철 태양광 발전 대응전략 및 서울시 태양광 현황'입니다.

# 슬라이드 2: 분석 배경·목표

장마철에는 일사량 증가에도 불구하고 높은 습도, 구름, 집중호우로 인해 태양광 발전 공백이 반복적으로 발생합니다.
이에 따라 안정적인 에너지 공급을 위해 이에 대한 정량적 분석과 대응전략이 필요하다고 판단했습니다.

본 프로젝트는 크게 세 가지 목표를 가지고 진행되었습니다.

첫째, 장마철 6~7월과 비장마철 4~5월의 태양광 발전량을 비교하고 강수량과의 상관관계를 분석합니다.
둘째, 최악의 시나리오 기반으로 4인 가구 ESS 최소 필요 용량을 산정합니다.
셋째, 연속 강우일 시뮬레이션을 통한 가정용 에너지 자립도 평가와 서울시 자치구별 태양광 발전소 분포를 시각화하고 지역별 인프라 현황 파악을 목표로 했습니다.

# 슬라이드 3: 프로젝트 수행 절차

프로젝트는 총 5주차에 걸쳐 단계적으로 진행되었습니다

1주차에는 주제 선정 및 프로젝트 계획서를 작성했습니다
2~3주차에는 데이터 수집과 전처리 작업을 진행했습니다. 2020년부터 2025년까지 강수량과 일사량 월별 데이터를 수집하고 기상청 데이터를 정제했습니다.
3주차에는 발전량 분석 단계로, 장마철과 비장마철의 발전량을 비교하고 강수량과의 상관관계를 분석했습니다
3~4주차에는 통계 분석과 시각화 작업을 진행했습니다. 히스토그램 및 꺾은선 그래프로 시각화를 완성했습니다
4주차에는 에너지 자립 전략 수립 단계로, 연속 강우일 시뮬레이션을 진행했습니다
마지막 5주차에서는 지역분석 단계로, folium을 활용해 서울시 자치구별 태양광 발전소 분포를 지도로 시각화했습니다.

# 슬라이드 4: 프로젝트 활용 장비 및 재료

- Python 3.13.7 버전을 가상환경에서 사용했습니다
- 개발 도구로는 Jupyter Notebook과 VS Code를 활용했으며
- GitHub를 통해 버전 관리를 진행했습니다

데이터 분석의 기본이 되는 Pandas로 CSV 데이터를 불러오고 전처리했습니다.
Numpy는 수치 계산 및 통계 분석에 활용했습니다
시각화 부분에서는 matplotlib로 기본 그래프를 그렸고, seaborn으로 통계 기반 히트맵을 제작했습니다.
날짜 처리를 위해 datetime 라이브러리를 import 했으며
마지막으로 folium은 지도 기반 시각화에 사용했습니다

이러한 라이브러리들을 활용해 강수량과 태양광 발전량 간 관계, 에너지 자립 시뮬레이션, 그리고 서울시 자치구별 태양광 현황을 분석했습니다.

# 슬라이드 5~6: 1. 데이터 수집 전처리 - 데이터 로드

본격적인 분석에 앞서 데이터 수집과 전처리 과정을 설명드리겠습니다.
먼저 pandas 라이브러리를 import 했습니다.

기상청 데이터는 cp949 인코딩을 사용하기 떄문에, 이를 처리하는 함수를 작성했습니다.
함수의 첫 단계에서는 실제 데이터가 시작되는 행 번호를 저장합니다. 처음에는 알 수 없으므로 None으로 시작합니다
파일을 열어서 각 줄을 읽으며 '지점번호'라는 문자열이 나오는 행을 찾습니다. 이 행부터 실제 데이터가 시작됩니다.
그 다음 'pd.read_csv'로 파일을 불러오는데, encoding을 cp949로 지정하고 skiprows로 앞서 찾은 행까지 건너뜁니다.
컬럼명을 정리하기 위해 공백과 따옴표를 제거하고, 날짜 컬럼을 datetime 형식으로 변환합니다
마지막으로 날짜가 없는 행을 제거하고 날짜순으로 정렬한 후 인덱스를 리셋합니다

이 함수를 사용해 장마철 6~7월 강수량 데이터와 비장마철 4~5월 강수량 데이터를 불러왔습니다.

일사량 데이터도 유사한 방식으로 load_solar_csv 함수를 만들어 처리했습니다.
다만 일사량 데이터는 17행부터 시작하므로 skiprows를 17로 고정했습니다.

# 슬라이드 7: 2. 발전량 계산 - 변환 공식

일사량 데이터를 실제 태양광 발전량으로 변환하는 과정입니다

발전량(kWh)은 일사량(MJ/m²) × 0.2778 × 패널면적(20m²) × 효율(0.18) × 손실계수(0.8)로 계산됩니다.

- 패널 면적은 20m²로 일반 가정용 규모를 가정했습니다
- 패널 효율은 18%로, 상용 패널의 평균 효율을 적용했습니다
- 시스템 손실은 20%로, 인버터, 케이블, 온도 손실 등을 고려했습니다

먼저 전역 상수로 PANEL_AREA 20, EFFICIENCY 0.18, LOSS 0.8을 설정했습니다.

일사량 단위를 MJ/m²에서 kWh/m²로 변환하기 위해 0.2778을 곱했습니다.

그 다음 발전량 계산 공식을 적용해 일사량(kWh/m²)에 패널면적, 효율, 손실계수를 모두 곱해 최종 발전량(kWh)을 계산했습니다.

오른쪽 표를 보시면 실제 계산된 발전량 데이터를 확인하실 수 있습니다. 2020년 4월부터 2025년 5월까지의 데이터가 정리되어 있습니다.

# 슬라이드 8: 3. 발전량 분석 - 데이터 병합

이제 강수량 데이터와 일사량 데이터를 병합하는 단계입니다.

pandas의 merge 함수를 사용해 두 데이터프레임을 '일시' 컬럼 기준으로 병합했습니다.
장마철 데이터는 weather_67의 날짜와 강수량 컬럼, solar_67의 일사량과 발전량, 일조시간 컬럼을 합쳐 merged_67로 저장했습니다.
비장마철도 동일한 방식으로 merged_45를 생성했습니다.

병합된 데이터로 평균 발전량을 계산한 결과를 살펴보겠습니다.
비장마철 평균 발전량을 484kWh, 장마철 평균 발전량은 429kWh로 나타났습니다.
그 차이는 55kWh이며, 이는 장마철에 약 11.4%의 발전량 감소를 의미합니다.
이러한 발전량 감소는 장마철 강수와 낮은 일조시간 때문이며, 이를 보완하기 위한 ESS의 필요성을 보여줍니다.

# 슬라이드 9: ESS 용량 산정 - ESS 계산 함수

ESS 용량을 산정하는 핵심 함수를 설명드리겠습니다

월 필요 전력량은 400kWh로, 4인 가구 평균 전력 소비를 기준으로 했습니다.
상용 ESS 최소 단위는 10kWh입니다

먼저 최악의 상황을 찾습니다. 발전량이 가장 적었던 달을 idsmin으로 찾아냅니다.
그 달의 발전량과 월 필요량 400kWh를 비교해 부족한 전력량을 계산합니다
권장 용량은 부족량에 1.2를 곱해 20% 안전 여유분을 더합니다.
마지막으로 상용 제품 단위인 10kWh로 올림 처리해 실제 구매 가능한 용량으로 변환합니다

계산 결과 장마철의 경우 평균 발전량은 429kWh, 최저 발전량으 322kWh(2024년 7월)였습니다.
부족 전력량은 78kWh이며, 권장 ESS 용량은 100kWh입니다.
비장마철은 평균 484kWh, 최저 398kWh(2023년 4월)로 부족량이 2kWh에 불과해 권장 용량은 10kWh입니다.

결론적으로 장마철 최악의 경우를 대비하려면 100kWh 용량의 ESS가 필요합니다

# 슬라이드 10: 데이터 시각화 - 장마철 월별 발전량 추이

이 슬라이드는 장마철 월별 발전량 추이를 시계열로 시각화한 것입니다.

`plt.plot`으로 시간에 따른 발전량 변화를 선 그래프로 그렸습니다. 마커는 원 모양, 색상은 파란색으로 설정했습니다.
`axhline`으로 y=400 위치에 빨간 점선을 그어 월 필요량 기준선을 표시했습니다.
`fill_between` 함수로 발전량이 400kWh 미만인 구간을 빨간색으로 채웠습니다. 이것이 부족 구간입니다.


위쪽 그래프는 장마철(6~7월) 발전량 추이입니다.
대부분의 구간에서 400kWh 기준선 위에 있어 안정적이지만, 2024년 7월에는 크게 떨어져 빨간 영역이 발생했습니다.

아래쪽 그래프는 비장마철(4~5월) 추이로, 전반적으로 높고 안정적인 발전량을 보입니다.

# 슬라이드 11: 5. 데이터 시각화 - ESS 필요량 분석

이 그래프는 ESS 필요량을 시각적으로 분석한 것입니다.


왼쪽 코드를 보시면 matplotlib의 subplots를 사용해 그래프를 생성했습니다.

# 슬라이드 12: 5. 데이터 시각화 - ESS 필요량 분석

파란색 막대는 실제 발전량을, 빨간색 막대는 부족량(ESS 필요)을 나타냅니다.
빨간 막대는 파란 막대 위에 쌓이는 형태(bottom 파라미터 사용)로 표현했습니다.
보라색 점선은 월 필요량 400kWh 기준선입니다.

장마철 평균의 경우 429kWh로 약간 부족한 수준입니다.

장마철 최악 시나리오에서는 발전량이 322kWh로 크게 떨어져 빨간 부분(ESS로 채워야 할 전력량)이 78kWh나 됩니다.
비장마철 평균은 484kWh로 기준선을 초과해 안정적입니다.

따라서 이 그래프에서 볼 수 있듯이 빨간 영역이 ESS로 채워야 할 전력량이며,
장마철 최악 시나리오 대비 약 100kWh 용량의 ESS가 필요하다는 것을 알 수 있습니다.

# 슬라이드 13: 심화 프로젝트

마지막으로 심화 프로젝트로 진행한 두 가지 주제를 소개합니다.

첫 번째는 연속 강우일에 초점을 맞춰 시제 가정의 에너지 자립도를 시뮬레이션했습니다.
시각화는 연속 강우 패턴 및 히트맵으로 표현했습니다

다음은 folium으로 발전소 분포를 직관적으로 확인할 수 있는 지도를 제작했고, 지역별 패턴을 분석했습니다.

# 슬라이드 14: 6. 에너지 자립 전략 - 연속 강우 분석

이제 심화 분석으로 연속 강우일 패턴을 살펴보겠습니다.

외쪽 코드에는 glob 라이브러리로 여러 CSV 파일을 한 번에 읽어왔습니다.
각 파일마다 '날짜' 행을 찾아 skiprows로 처리하고, 강수량을 숫자로 변환했습니다.
비가 온 날은 강수량이 1mm 이상인 날로 정의했습니다.

current 변수로 연속 일수를 카운트하고, 비가 오지 않으면 리셋합니다.
2일 이상 연속으로 비가 온 경우만 저장하고, 일수가 긴 순서대로 정렬했습니다.

오른쪽 결과를 보시면, 장마철 6~7월 총 366일 중 비가 온 날은 126일입니다.
연속 강우 2일 이상은 33번 발생했습니다.

TOP 5를 보면:
- 1위: 8일 연속 (2024-07-20)
- 2위: 7일 연속 (2025-07-14)
- 3위: 6일 연속 (2023-07-13)
- 4위, 5위: 5일 연속

6년간 최장 연속 강우는 8일이었음을 확인할 수 있습니다.

# 슬라이드 15: 6, 에너지 자립 전략 - 발전량 추정 모델, ESS 시뮬레이션

연속 강우일 동안의 발전량을 추정하는 모델입니다.

맑은 날 발전량은 30kWh/일, 하루 소비는 13kWh/일, ESS 용량은 30kWh(약 2일분)로 설정했습니다

비/흐린 날 태양광 효율은 맑은 날 대비 14~20% 수준입니다.
평균 강수량이 10mm 미만이면 맑은 날의 50%(경미한 강수), 10mm 이상이면 20%(집중 호우)로 추정했습니다.

전력 사용 우선순위는 1순위 태양광 발전, 2순위 ESS 저장 전력, 3순위 한전 전력입니다.

코드를 보시면 먼저 ESS를 초기 만충 상태(30kWh)로 설정하고,
매일 부족분을 ESS에서 먼저 사용한 후 남은 부족분을 한전에서 충당하는 방식입니다

오른쪽 표는 시뮬레이션 결과입니다.

1위는 8일 연속으로 총 강수량 184.3mm, 일일 발전 6kWh, 한전 사용 26kWh, 자급률 75%입니다.

# 슬라이드 16: 6. 에너지 자립 전략 - 히트맵

이 슬라이드는 TOP 5 연속 강우 기간의 종합 비교 히트맵입니다

왼쪽 코드를 보시면 먼저 normalize_01 함수로 각 열을 0~1 사이로 정규화했습니다.
이는 단위가 다른 지표들을 동일한 척도로 비교하기 위함입니다.

seaborn의 heatmap을 사용했고, 값이 낮으면 빨강, 높으면 초록으로 표시했습니다.

오른쪽 히트맵을 보시면, 1위(최악 시나리오)는 연속일수와 한전 사용량이 높아 빨간색이 많습니다.
4위는 강수량이 적고 일일발전량이 높으며 자급률이 우수해 초록색이 많습니다.

# 슬라이드 17: 7. 서울시 자치구별 태양광 발전 현황 - 데이터 소개

이제 서울시 자치구별 태양광 발전소 분포를 분석하겠습니다.

서울 열린 데이터 광장에서 '서울시 태양광발전사업 정보' 데이터를 다운로드했습니다.

'extract_gu' 함수를 만들어 도로명주소에서 자치구만 추출했습니다
'str.split()'으로 공백 기준으로 나누고, -구-로 끝나는 단어를 찾아 반환합니다

그 다음으로 groupby로 자치구별 설비용량 합계와 발전소 개수를 계산했습니다
오른쪽 표를 보시면 설비용량 큰 순서대로 정렬한 것을 확인할 수 있습니다.


# 슬라이드 18: 7. 서울시 자치구별 태양광 발전 현황 - Folium 지도 시각화

다음은 folium 라이브러리를 활용해서 표현한 지도입니다.

먼저 25개 자치구의 중심 좌표를 딕셔너리로 정의했습니다.

folium.Map으로 서울 중심 좌표에 줌 레벨 11의 지도를 생성했습니다.
다음으로 각 자치구에 마커를 추가하는데, 발전소 수에 따라 색상을 다르게 설정했습니다:
- 파랑: 발전소 최다
- 초록: 30개 이상
- 주황: 20~29개
- 빨강: 20개 미만
- 보라: 발전소 최소

# 슬라이드 19: 7. 서울시 자치구별 태양광 발전 현황 - Folium 지도 시각화

오른쪽 지도를 보시면 강서구가 파란색으로 표시되어 발전소가 가장 많습니다.
강남구, 노원구, 광진구는 초록색으로 30개 이상입니다.
용산구는 보라색으로 발전소가 가장 적습니다.


